pipeline {
    agent any

    stages {
        stage( "build" ) {
            when {
                changeset "**/result/**"
            }
            steps {
                echo "Build result app"
                dir( "result" ) {
                    nodejs( nodeJSInstallationName: "node-8_9_0" ) {
                        sh "npm install"
                    }
                }
            }
        }
        stage( "test" ) {
            when {
                changeset "**/result/**"
            }
            steps {
                echo "Test result app"
                dir( "result" ) {
                    nodejs( nodeJSInstallationName: "node-8_9_0" ) {
                        sh "npm install"
                        sh "npm test"
                    }
                }
            }
        }
    }
    post {
        always {
            echo "Building multibranch pipeline for result is completed.."
        }
    }
}